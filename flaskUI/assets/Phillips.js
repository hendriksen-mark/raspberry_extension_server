import{r as t,j as s,G as P,a as g,n as i}from"./index.js";import{G as n}from"./GenericText.js";import{G as U}from"./GlassContainer.js";import{P as E}from"./PageContent.js";import{C as H}from"./CardGrid.js";const M=({HOST_IP:y,API_KEY:j,CONFIG:r})=>{var p,m,f;const[o,l]=t.useState(((p=r.config.hue)==null?void 0:p.ip)||"192.168.x.x"),[c,d]=t.useState(((m=r.config.hue)==null?void 0:m.hueUser)||""),[v,u]=t.useState(((f=r.config.hue)==null?void 0:f.hueKey)||""),[h,b]=t.useState(!1);t.useEffect(()=>{var e,a,x;h||(l(((e=r.config.hue)==null?void 0:e.ip)||"192.168.x.x"),d(((a=r.config.hue)==null?void 0:a.hueUser)||""),u(((x=r.config.hue)==null?void 0:x.hueKey)||""))},[r,h]);const B=e=>{l(e),b(!0)},K=()=>{g.post(`http://${o}/api`,{devicetype:"diyhue#bridge",generateclientkey:!0}).then(e=>{"success"in e.data[0]?(d(e.data[0].success.username),u(e.data[0].success.clientkey),g.put(`${y}/api/${j}/config`,{hue:{ip:o,hueUser:e.data[0].success.username,hueKey:e.data[0].success.clientkey}}).then(a=>{i.success("Connected, now scan for lights")}).catch(a=>{console.error(a),i.error(`Error occurred: ${a.message}`)})):i.error(e.data[0].error.description)}).catch(e=>{console.error(e),i.error(`Error occurred: ${e.message}`)})};return s.jsx("div",{className:"inner",children:s.jsx(H,{options:"main",children:s.jsx(U,{children:s.jsxs(E,{children:[s.jsx("div",{className:"headline",children:"Pair original Hue Bridge"}),s.jsxs("form",{className:"add-form",children:[s.jsx("div",{className:"form-control",children:s.jsx(n,{label:"Bridge Ip",type:"text",placeholder:"192.168.x.x",value:o,onChange:e=>B(e)})}),s.jsx("div",{className:"form-control",children:s.jsx(n,{label:"Hue User",type:"text",placeholder:"Automatically populated",readOnly:!0,value:c})}),s.jsx("div",{className:"form-control",children:s.jsx(n,{label:"Hue Key",type:"text",placeholder:"Automatically populated",readOnly:!0,value:v})}),s.jsx("div",{className:"form-control",children:s.jsx(P,{value:typeof c=="string"&&c.length>0?"Pair again":"Pair",color:"blue",size:"",type:"submit",onClick:()=>K()})})]})]})})})})};export{M as default};
