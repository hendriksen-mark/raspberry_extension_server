import{r as u,ay as J,az as Y,aA as F,j as e,aB as k,aw as g,T as S,aC as Z,aD as q,aE as Q,aF as _,aG as ee,a as C,f as L,g as te,aH as se,F as D,W as ne,aI as ie,c as ae,aJ as P}from"./index.js";import{c as E,i as T,r as re,a as R,G as oe}from"./GradientColorpicker.js";import{S as ce}from"./SelectMenu.js";import{B as U}from"./BrightnessSlider.js";import{H as V}from"./hass-hue-icons.js";import{a as le}from"./index2.js";const de=u.createContext(null);function ue(){const t=u.useRef(!1);return J(()=>(t.current=!0,()=>{t.current=!1}),[]),t}function pe(){const t=ue(),[s,a]=u.useState(0),n=u.useCallback(()=>{t.current&&a(s+1)},[s]);return[u.useCallback(()=>Y.postRender(n),[n]),s]}const he=t=>!t.isLayoutDirty&&t.willUpdate(!1);function A(){const t=new Set,s=new WeakMap,a=()=>t.forEach(he);return{add:n=>{t.add(n),s.set(n,n.addEventListener("willUpdate",a))},remove:n=>{t.delete(n);const i=s.get(n);i&&(i(),s.delete(n)),a()},dirty:a}}const O=t=>t===!0,fe=t=>O(t===!0)||t==="id",xe=({children:t,id:s,inherit:a=!0})=>{const n=u.useContext(F),i=u.useContext(de),[c,r]=pe(),d=u.useRef(null),l=n.id||i;d.current===null&&(fe(a)&&l&&(s=s?l+"-"+s:l),d.current={id:s,group:O(a)&&n.group||A()});const p=u.useMemo(()=>({...d.current,forceRender:c}),[r]);return e.jsx(F.Provider,{value:p,children:t})},me=({showContainer:t,setShowContainer:s,lightsCapabilities:a,setSceneModal:n})=>{const i={opened:{opacity:1},closed:{opacity:0}};return e.jsx(k,{mode:"wait",children:t!=="closed"&&e.jsxs(g.div,{className:"row buttons",initial:"closed",animate:"opened",exit:"closed",variants:i,transition:{duration:.2},children:[a.includes("gradient")&&e.jsx(g.div,{className:`btn ${t==="gradient"?"active":""}`,whileHover:{scale:1.2},whileTap:{scale:.9},children:e.jsx(S,{title:e.jsx("p",{style:{fontSize:"18px"},children:"Gradient"}),arrow:!0,children:e.jsx("div",{children:e.jsx(Z,{onClick:()=>s("gradient")})})})}),a.includes("xy")&&e.jsx(g.div,{className:`btn ${t==="colorPicker"?"active":""}`,whileHover:{scale:1.2},whileTap:{scale:.9},children:e.jsx(S,{title:e.jsx("p",{style:{fontSize:"18px"},children:"ColorPicker"}),arrow:!0,children:e.jsx("div",{children:e.jsx(q,{onClick:()=>s("colorPicker")})})})}),a.includes("ct")&&e.jsx(g.div,{className:`btn ${t==="colorTempPicker"?"active":""}`,whileHover:{scale:1.2},whileTap:{scale:.9},children:e.jsx(S,{title:e.jsx("p",{style:{fontSize:"18px"},children:"ColorTempPicker"}),arrow:!0,children:e.jsx("div",{children:e.jsx(Q,{onClick:()=>s("colorTempPicker")})})})}),e.jsx(g.div,{className:"btn",whileHover:{scale:1.2},whileTap:{scale:.9},children:e.jsx(S,{title:e.jsx("p",{style:{fontSize:"18px"},children:"Scenes"}),arrow:!0,children:e.jsx("div",{children:e.jsx(_,{onClick:()=>n(!0)})})})}),e.jsx(g.div,{className:`btn ${t==="lights"?"active":""}`,whileHover:{scale:1.2},whileTap:{scale:.9},children:e.jsx(S,{title:e.jsx("p",{style:{fontSize:"18px"},children:"Lights"}),arrow:!0,children:e.jsx("div",{children:e.jsx(ee,{onClick:()=>s("lights")})})})})]},"buttons")})};function je({HOST_IP:t,api_key:s,lights:a,groupLights:n}){const i=u.useRef(null),c=u.useRef(null);return u.useEffect(()=>{const r=p=>{let h=p.rgb;C.put(`${t}/api/${s}/lights/${n[p.index]}/state`,{xy:re(h.r,h.g,h.b)})};let d=[];for(var l of n.entries())if(l=l[1],"xy"in a[l].state){const[p,h]=a[l].state.xy;p===0&&h===0?d.push({r:255,g:255,b:255}):d.push(E(p,h,254))}i.current&&!c.current&&(c.current=new T.ColorPicker(i.current,{layout:[{component:T.ui.Wheel,options:{}}],colors:d}),c.current.on("input:end",r))},[n,a,t,s]),e.jsx("div",{ref:i})}const ge=({showContainer:t,group:s,lights:a,HOST_IP:n,api_key:i})=>e.jsx(g.div,{className:"row colorpicker",children:e.jsx(k,{initial:!1,mode:"wait",children:t==="colorPicker"&&e.jsx(g.section,{initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,scale:1,height:"auto"},collapsed:{opacity:0,scale:.5,height:0}},transition:{duration:.2},children:e.jsx(je,{group:s,lights:a,HOST_IP:n,api_key:i,groupLights:s.lights})},"content")})});function ve({HOST_IP:t,api_key:s,group:a,groupId:n}){const i=u.useRef(null),c=u.useRef(null);return u.useEffect(()=>{const r=d=>{let l=d.kelvin,p=Math.floor((11e3-l)/25.5+153);C.put(`${t}/api/${s}/groups/${n}/action`,{ct:p})};i.current&&!c.current&&(c.current=new T.ColorPicker(i.current,{layoutDirection:"horizontal",layout:[{component:T.ui.Slider,options:{sliderType:"kelvin",sliderShape:"circle"}}],color:R(a.action.ct)}),c.current.on("input:end",r,{passive:!0}))},[a,n,t,s]),e.jsx("div",{ref:i})}const be=({showContainer:t,group:s,groupId:a,HOST_IP:n,api_key:i})=>e.jsx(g.div,{className:"row colorpicker",children:e.jsx(k,{initial:!1,mode:"wait",children:t==="colorTempPicker"&&e.jsx(g.section,{initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto",scale:1},collapsed:{opacity:0,scale:.5,height:0}},transition:{duration:.2},children:e.jsx(ve,{group:s,groupId:a,HOST_IP:n,api_key:i})},"content")})}),ye=({showContainer:t,gradientLights:s,HOST_IP:a,api_key:n})=>{const[i,c]=u.useState(s.length>0?s[0].value:"");u.useEffect(()=>{},[i]);const r=d=>{c(d.value)};return e.jsx(g.div,{className:"row colorpicker",children:e.jsx(k,{initial:!1,mode:"wait",children:t==="gradient"&&e.jsxs(g.section,{initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,scale:1,height:"auto"},collapsed:{opacity:0,scale:.5,height:0}},transition:{duration:.2},children:[e.jsx(ce,{value:s.find(d=>d.value===i),options:s,onChange:r}),e.jsx("br",{}),e.jsx(oe,{HOST_IP:a,API_KEY:n,light:i})]},"content")})})};var ke="Expected a function",B=NaN,Ce="[object Symbol]",we=/^\s+|\s+$/g,Se=/^[-+]0x[0-9a-f]+$/i,Ne=/^0b[01]+$/i,$e=/^0o[0-7]+$/i,Le=parseInt,Te=typeof L=="object"&&L&&L.Object===Object&&L,Ee=typeof self=="object"&&self&&self.Object===Object&&self,Re=Te||Ee||Function("return this")(),Me=Object.prototype,Ge=Me.toString,Ie=Math.max,ze=Math.min,G=function(){return Re.Date.now()};function Fe(t,s,a){var n,i,c,r,d,l,p=0,h=!1,o=!1,f=!0;if(typeof t!="function")throw new TypeError(ke);s=H(s)||0,I(a)&&(h=!!a.leading,o="maxWait"in a,c=o?Ie(H(a.maxWait)||0,s):c,f="trailing"in a?!!a.trailing:f);function j(x){var y=n,w=i;return n=i=void 0,p=x,r=t.apply(w,y),r}function b(x){return p=x,d=setTimeout(v,s),h?j(x):r}function N(x){var y=x-l,w=x-p,z=s-y;return o?ze(z,c-w):z}function m(x){var y=x-l,w=x-p;return l===void 0||y>=s||y<0||o&&w>=c}function v(){var x=G();if(m(x))return $(x);d=setTimeout(v,N(x))}function $(x){return d=void 0,f&&n?j(x):(n=i=void 0,r)}function K(){d!==void 0&&clearTimeout(d),p=0,n=l=i=d=void 0}function X(){return d===void 0?r:$(G())}function M(){var x=G(),y=m(x);if(n=arguments,i=this,l=x,y){if(d===void 0)return b(l);if(o)return d=setTimeout(v,s),j(l)}return d===void 0&&(d=setTimeout(v,s)),r}return M.cancel=K,M.flush=X,M}function I(t){var s=typeof t;return!!t&&(s=="object"||s=="function")}function Pe(t){return!!t&&typeof t=="object"}function Ae(t){return typeof t=="symbol"||Pe(t)&&Ge.call(t)==Ce}function H(t){if(typeof t=="number")return t;if(Ae(t))return B;if(I(t)){var s=typeof t.valueOf=="function"?t.valueOf():t;t=I(s)?s+"":s}if(typeof t!="string")return t===0?t:+t;t=t.replace(we,"");var a=Ne.test(t);return a||$e.test(t)?Le(t.slice(2),a?2:8):Se.test(t)?B:+t}var Be=Fe;const He=te(Be),We=({group:t,lights:s})=>{const a=()=>{if(t.state.any_on){let n="linear-gradient(45deg, rgba(200,200,200,1) 0%,",i=100/t.lights.length;for(const[c,r]of t.lights.entries())s[r].state.colormode==="xy"&&s[r].state.on?n=n+E(s[r].state.xy[0],s[r].state.xy[1],254)+" "+Math.floor(i*(c+1))+"%,":s[r].state.colormode==="ct"&&s[r].state.on?n=n+R(s[r].state.ct)+" "+Math.floor(i*(c+1))+"%,":s[r].state.on&&(n=n+"rgba(255,212,93,1) "+Math.floor(i*(c+1))+"%,");return{background:n.slice(0,-1)+")"}}};return e.jsx("div",{className:"gradient",style:a(),children:t.type==="Zone"?e.jsx(se,{style:{fill:t.state.any_on?"#3a3a3a":"#ddd"}}):e.jsx(V,{type:"room-"+t.class,color:t.state.any_on?"#3a3a3a":"#ddd"})})},De=({HOST_IP:t,api_key:s,id:a,group:n,lights:i})=>{const[c,r]=u.useState(n.state);u.useEffect(()=>{r(n.state)},[n]);const d=o=>{const f={on:o};r(j=>({...j,any_on:o})),C.put(`${t}/api/${s}/groups/${a}/action`,f)},l=o=>{r(j=>({...j,bri:o}));const f={bri:o};C.put(`${t}/api/${s}/groups/${a}/action`,f)},p=()=>{let o=0,f=0;for(const j of n.lights)i[j].state.on===!0?o=o+1:f=f+1;return o===0?"All lights off":f===0?"All lights on":o+" lights on"},h=He(l,300);return u.useCallback(o=>{h(o)},[]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"row top",children:[e.jsx(We,{group:n,lights:i}),e.jsxs("div",{className:"text",children:[e.jsxs("p",{className:"name",children:[" ",n.name," "]}),e.jsx("p",{className:"subtext",children:p()})]}),e.jsx("div",{className:"flipSwitch",children:e.jsx(D,{id:"group "+a,value:c.any_on,onChange:o=>d(o),checked:c.any_on})})]}),e.jsx("div",{className:"row background",children:e.jsx(k,{initial:!1,children:c.any_on&&e.jsx(U,{defaultValue:c.avr_bri,onChange:h,max:100})})})]})},Ue=({HOST_IP:t,api_key:s,id:a,light:n})=>{const[i,c]=u.useState(n);u.useEffect(()=>{c(n)},[n]);const r=l=>{C.put(`${t}/api/${s}/lights/${a}/state`,l).then(p=>{c(h=>({...h,state:{...h.state,...l}}))}).catch(p=>{console.error("Error updating light state:",p)})},d=()=>{if(i.state.on){let l;return i.state.colormode==="xy"?l=E(i.state.xy[0],i.state.xy[1],254):i.state.colormode==="ct"?l=R(i.state.ct):l="rgba(255,212,93,1)",{background:l}}};return e.jsxs("div",{className:"groupCard light",children:[e.jsxs("div",{className:"row top",children:[e.jsx("div",{className:"gradient",style:d(),children:e.jsx(V,{type:"light-"+i.config.archetype,color:"#eeeeee"})}),e.jsx("div",{className:"text",children:e.jsxs("p",{className:"name",children:[i.name," ",i.state.reachable||e.jsx(le,{title:"Unreachable"})]})}),e.jsx(D,{id:"light "+a,value:i.state.on,checked:i.state.on,onChange:l=>r({on:l})})]}),e.jsx("div",{className:"row background",children:e.jsx(k,{initial:!1,children:i.state.on&&e.jsx(U,{defaultValue:i.state.bri,onChange:l=>r({bri:l})})})})]})},Ve=({showContainer:t,group:s,lights:a,HOST_IP:n,api_key:i})=>e.jsx(g.div,{className:"row colorpicker",children:e.jsx(k,{initial:!1,mode:"wait",children:t==="lights"&&e.jsx(g.div,{className:"lights",initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,scale:1,height:"auto"},collapsed:{opacity:0,scale:.5,height:0}},transition:{duration:.2},children:s.lights.map(c=>e.jsx(Ue,{HOST_IP:n,api_key:i,id:c,light:a[c]},c))})})}),Oe="/assets/nightsky.webp",Ke=({HOST_IP:t,api_key:s,groupId:a,group:n,scenes:i,sceneModal:c,setSceneModal:r})=>{const d=o=>{C.put(`${t}/api/${s}/groups/0/action`,{scene:o})},l=(o,f)=>{C.put(`${t}/api/${s}/lights/${o}/state`,f)};function p(){r(!1)}const h=o=>{let f;return"xy"in o?f=E(o.xy[0],o.xy[1],254):"ct"in o?f=R(o.ct):f="rgba(200,200,200,1)",f};return e.jsx(ne,{isOpen:c,closeWizard:p,headline:"Scene Picker for "+n.name,children:Object.entries(i).filter(o=>o[1].group===a).map(([o,f])=>e.jsxs("div",{className:"scene",style:{background:`url(${Oe})`,backgroundSize:"300px 125px"},onClick:()=>d(o),children:[e.jsxs("div",{className:"dimmer",children:[Object.entries(f.lightstates).filter((j,b)=>b<5).map(([j,b])=>e.jsx("div",{className:"color",style:{background:`${h(b)}`},onClick:()=>l(j,b)},j)),e.jsx("div",{className:"name",children:f.name})]}),e.jsx("div",{className:"dynamiccontrol",children:e.jsx("i",{className:"far fa-play-circle"})})]},o))})},_e=({HOST_IP:t,api_key:s,id:a,group:n,lights:i,scenes:c})=>{const[r,d]=u.useState(()=>localStorage.getItem(`showContainer-${a}`)||"closed"),[l,p]=u.useState(!1),[h,o]=u.useState([]),[f,j]=u.useState([{value:"",label:"Select a light"}]);u.useEffect(()=>{b()},[n.lights,i]);const b=()=>{for(const m of n.lights)"xy"in i[m].state&&!h.includes("xy")&&o(v=>[...v,"xy"]),"ct"in i[m].state&&!h.includes("ct")&&o(v=>[...v,"ct"]),(i[m].modelid.startsWith("LCX")||i[m].modelid==="915005987201")&&!h.includes("gradient")&&(o(v=>[...v,"gradient"]),j(v=>v.some($=>$.value===m)?v:[...v,{value:m,label:i[m].name}]))},N=()=>{let m;r==="closed"?h.includes("xy")?m="colorPicker":h.includes("ct")?m="colorTempPicker":h.includes("gradient")?m="gradient":m="lights":m="closed",d(m),localStorage.setItem(`showContainer-${a}`,m)};return e.jsxs("div",{className:"groupCard",children:[e.jsx(Ke,{HOST_IP:t,api_key:s,groupId:a,group:n,scenes:c,sceneModal:l,setSceneModal:p}),e.jsxs(xe,{children:[e.jsx(De,{group:n,lights:i,HOST_IP:t,api_key:s,id:a}),e.jsx(me,{defaultContainerView:N,showContainer:r,setShowContainer:d,lightsCapabilities:h,setSceneModal:p}),e.jsx(ye,{showContainer:r,gradientLights:f,HOST_IP:t,api_key:s}),e.jsx(ge,{showContainer:r,group:n,lights:i,HOST_IP:t,api_key:s}),e.jsx(be,{showContainer:r,group:n,groupId:a,HOST_IP:t,api_key:s}),e.jsx(Ve,{showContainer:r,group:n,lights:i,HOST_IP:t,api_key:s})]}),e.jsx(k,{children:e.jsx("div",{className:"row bottom",children:e.jsx(g.div,{className:"expandbtn",initial:"collapsed",animate:r==="closed"?"collapsed":"open",whileHover:{scale:1.2},whileTap:{scale:.9},variants:{open:{rotate:180},collapsed:{rotate:0}},transition:{duration:.3},onClick:()=>N(),children:e.jsx(ie,{})})})})]})};function W(t){return ae({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M144 268.4V358c0 6.9 4.5 14 11.4 14H184v52c0 13.3 10.7 24 24 24s24-10.7 24-24v-52h49v52c0 7.5 3.4 14.2 8.8 18.6 3.9 3.4 9.1 5.4 14.7 5.4h.5c13.3 0 24-10.7 24-24v-52h27.6c7 0 11.4-7.1 11.4-13.9V192H144v76.4zM408 176c-13.3 0-24 10.7-24 24v96c0 13.3 10.7 24 24 24s24-10.7 24-24v-96c0-13.3-10.7-24-24-24zM104 176c-13.3 0-24 10.7-24 24v96c0 13.3 10.7 24 24 24s24-10.7 24-24v-96c0-13.3-10.7-24-24-24z"},child:[]},{tag:"g",attr:{},child:[{tag:"path",attr:{d:"M311.2 89.1l18.5-21.9c.4-.5-.2-1.6-1.3-2.5-1.1-.8-2.4-1-2.7-.4l-19.2 22.8c-13.6-5.4-30.2-8.8-50.6-8.8-20.5-.1-37.2 3.2-50.8 8.5l-19-22.4c-.4-.5-1.6-.4-2.7.4s-1.7 1.8-1.3 2.5l18.3 21.6c-48.2 20.9-55.4 72.2-56.4 87.2h223.6c-.9-15.1-8-65.7-56.4-87zm-104.4 49.8c-7.4 0-13.5-6-13.5-13.3 0-7.3 6-13.3 13.5-13.3 7.4 0 13.5 6 13.5 13.3 0 7.3-6 13.3-13.5 13.3zm98.4 0c-7.4 0-13.5-6-13.5-13.3 0-7.3 6-13.3 13.5-13.3 7.4 0 13.5 6 13.5 13.3 0 7.3-6.1 13.3-13.5 13.3z"},child:[]}]}]})(t)}function et(){return e.jsxs("div",{className:"roomsetup",children:[e.jsx("p",{children:"There are no rooms or zones created yet. Use Hue Essentials or Hue app to set up this bridge."}),e.jsxs("div",{className:"storebutton",children:[e.jsx("img",{src:"https://is4-ssl.mzstatic.com/image/thumb/Purple122/v4/13/34/4f/13344f80-706e-257c-c72b-e9d698a33bc5/AppIcon-1x_U007emarketing-0-7-0-85-220.png/246x0w.webp",alt:"Hue Essential App"}),e.jsx("p",{children:"Hue Essentials"}),e.jsx("a",{href:"https://apps.apple.com/com/app/hue-essentials/id1462943921",children:e.jsx(P,{})}),e.jsx("a",{href:"https://play.google.com/store/apps/details?id=com.superthomaslab.hueessentials",children:e.jsx(W,{})})]}),e.jsxs("div",{className:"storebutton",children:[e.jsx("img",{src:"https://is3-ssl.mzstatic.com/image/thumb/Purple112/v4/a8/30/a2/a830a22d-e50b-d1d7-0824-457beac55874/AppIcon-1x_U007emarketing-0-7-0-85-220.png/246x0w.webp",alt:"Phillips Hue App"}),e.jsx("p",{children:"Phillips Hue"}),e.jsx("a",{href:"https://apps.apple.com/us/app/philips-hue/id1055281310",children:e.jsx(P,{})}),e.jsx("a",{href:"https://play.google.com/store/apps/details?id=com.philips.lighting.hue2",children:e.jsx(W,{})})]})]})}export{_e as G,et as R};
