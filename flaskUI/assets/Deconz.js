import{r as s,j as o,F as $,G as k,a as y,n as l}from"./index.js";import{G as h}from"./GenericText.js";import{G as M}from"./GlassContainer.js";import{P as q}from"./PageContent.js";import{C as w}from"./CardGrid.js";const K=({HOST_IP:P,API_KEY:E,CONFIG:n})=>{var x,g,j,b;const[t,z]=s.useState(((x=n.config.deconz)==null?void 0:x.enabled)||!1),[c,f]=s.useState(((g=n.config.deconz)==null?void 0:g.deconzHost)||"192.168.x.x"),[a,m]=s.useState(((j=n.config.deconz)==null?void 0:j.deconzPort)||80),[r,p]=s.useState(((b=n.config.deconz)==null?void 0:b.deconzUser)||""),[u,i]=s.useState(!1);s.useEffect(()=>{var e,d,D,v;u||(z(((e=n.config.deconz)==null?void 0:e.enabled)||!1),f(((d=n.config.deconz)==null?void 0:d.deconzHost)||"192.168.x.x"),m(((D=n.config.deconz)==null?void 0:D.deconzPort)||80),p(((v=n.config.deconz)==null?void 0:v.deconzUser)||""))},[n,u]);const S=e=>{z(e),i(!0)},U=e=>{f(e),i(!0)},H=e=>{m(parseInt(e)),i(!0)},C=()=>{y.post(`http://${c}:${a}/api`,{devicetype:"diyhue#bridge"},{timeout:2e3}).then(e=>{"success"in e.data[0]?(p(e.data[0].success.username),y.put(`${P}/api/${E}/config`,{deconz:{enabled:t,deconzHost:c,deconzPort:a,deconzUser:e.data[0].success.username}}).then(d=>{l.success("Connected, service restart required.")})):l.error(e.data[0].error.description)}).catch(e=>{console.error(e),l.error(e.message)})};return o.jsx("div",{className:"inner",children:o.jsx(w,{options:"main",children:o.jsx(M,{children:o.jsxs(q,{children:[o.jsx("div",{className:"headline",children:"Deconz Config"}),o.jsxs("form",{className:"add-form",children:[o.jsx($,{id:"Deconz",value:t,onChange:e=>S(e),checked:t,label:"Enable",position:"right"}),o.jsx("div",{className:"form-control",children:o.jsx(h,{label:"Deconz host",type:"text",placeholder:"Deconz host",value:c,onChange:e=>U(e)})}),o.jsx("div",{className:"form-control",children:o.jsx(h,{label:"Deconz port",type:"number",placeholder:"Deconz port",value:a,onChange:e=>H(e)})}),o.jsx("div",{className:"form-control",children:o.jsx(h,{label:"Deconz User",type:"text",placeholder:"Automatically populated",readOnly:!0,value:r})}),o.jsx("div",{className:"form-control",children:o.jsx(k,{value:typeof r=="string"&&r.length>0?"Pair again":"Pair",color:"blue",size:"",type:"submit",onClick:()=>C()})})]})]})})})})};export{K as default};
